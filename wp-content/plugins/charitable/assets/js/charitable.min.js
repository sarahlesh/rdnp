/*!  1.4.9 2017-01-18 11:02 */
CHARITABLE=window.CHARITABLE||{},function(a,b){var c=function(a){this.errors=[],this.form=a,this.pause_processing=!1;var c=this,d=b("body"),e=function(){b(this).closest("li").find("input[name=donation_amount]").prop("checked",!0).trigger("change"),d.off("focus","input.custom-donation-input",e),b(this).focus(),d.on("focus","input.custom-donation-input",e)},f=function(){var a=c.unformat_amount(b(this).val());b.trim(a)>0&&b(this).val(c.format_amount(a))},g=function(){var a=b(this).closest("li");a.hasClass("selected")||(a.parents(".charitable-donation-form").find(".donation-amount.selected").removeClass("selected"),a.addClass("selected"),a.hasClass("custom-donation-amount")&&a.find("input.custom-donation-input").focus())},h=function(){c.hide_inactive_payment_methods(),c.show_active_payment_methods(b(this).val())},i=!1,j=function(){if(i)return!1;i=!0;var a=b(this),c=new CHARITABLE.Donation_Form(a);return c.show_processing(),!1===c.validate()?(c.hide_processing(),c.print_errors(),c.scroll_to_top(),i=!1,!1):!1!==c.pause_processing?!1:1!==a.data("use-ajax")?!0:(d.trigger("charitable:form:process",c),!1)},k=function(a,c){var d=c.get_data();c.form;return d.action="make_donation",d.form_action=d.charitable_action,delete d.charitable_action,b.ajax({type:"POST",data:d,dataType:"json",url:CHARITABLE_VARS.ajaxurl,xhrFields:{withCredentials:!0},success:function(a){a.success?window.location.href=a.redirect_to:(c.hide_processing(),c.print_errors(a.errors),c.scroll_to_top())}}).fail(function(a,b,d){window.console&&window.console.log&&console.log(a),c.hide_processing(),c.print_errors([CHARITABLE_VARS.error_unknown]),c.scroll_to_top()}).always(function(a){i=!1}),!1},l=function(){c.form.find(".donation-amount input:checked").each(function(){b(this).closest("li").addClass("selected")}),c.get_all_payment_methods().length&&(c.hide_inactive_payment_methods(),c.form.on("change","#charitable-gateway-selector input[name=gateway]",h)),d.trigger("charitable:form:loaded",c)},m=function(){d.on("click",".donation-amount",g),d.on("focus","input.custom-donation-input",e),d.on("blur",".custom-donation-input",f),d.on("submit",".charitable-donation-form",j),d.on("charitable:form:process",k),d.trigger("charitable:form:initialize",c),CHARITABLE.forms_initialized=!0};l(),!1===CHARITABLE.forms_initialized&&m()};c.prototype.get_input=function(a){return this.form.find("[name="+a+"]")},c.prototype.get_email=function(){return this.form.find("[name=email]").val()},c.prototype.get_amount=function(){var a=suggested=parseFloat(this.form.find("[name=donation_amount]:checked").val());return isNaN(suggested)&&(a=parseFloat(this.form.find(".custom-donation-input").val())),(isNaN(a)||0>=a)&&(a=0),a},c.prototype.get_description=function(){return this.form.find("[name=description]").val()||""},c.prototype.get_cc_number=function(){return this.form.find("#charitable_field_cc_number input").val()||""},c.prototype.get_cc_cvc=function(){return this.form.find("#charitable_field_cc_cvc input").val()||""},c.prototype.get_cc_expiry_month=function(){return this.form.find("#charitable_field_cc_expiration select.month").val()||""},c.prototype.get_cc_expiry_year=function(){return this.form.find("#charitable_field_cc_expiration select.year").val()||""},c.prototype.clear_cc_fields=function(){this.form.find("#charitable_field_cc_number input, #charitable_field_cc_name input, #charitable_field_cc_cvc input, #charitable_field_cc_expiration select").removeAttr("name")},c.prototype.get_payment_method=function(){return this.form.find("[type=hidden][name=gateway], [name=gateway]:checked").val()||""},c.prototype.get_all_payment_methods=function(){return this.form.find("#charitable-gateway-selector input[name=gateway]")},c.prototype.hide_inactive_payment_methods=function(){var a=this.get_payment_method();this.form.find(".charitable-gateway-fields[data-gateway!="+a+"]").hide()},c.prototype.show_active_payment_methods=function(a){var a=a||this.get_payment_method();this.form.find(".charitable-gateway-fields[data-gateway="+a+"]").show()},c.prototype.format_amount=function(a,b){return"undefined"==typeof b&&(b=""),accounting.formatMoney(a,{symbol:b,decimal:CHARITABLE_VARS.currency_format_decimal_sep,thousand:CHARITABLE_VARS.currency_format_thousand_sep,precision:CHARITABLE_VARS.currency_format_num_decimals,format:CHARITABLE_VARS.currency_format}).trim()},c.prototype.unformat_amount=function(a){return Math.abs(parseFloat(accounting.unformat(a,CHARITABLE_VARS.currency_format_decimal_sep)))},c.prototype.add_error=function(a){this.errors.push(a)},c.prototype.get_errors=function(){return this.errors},c.prototype.get_error_message=function(){return this.errors.join(" ")},c.prototype.print_errors=function(a){var b=a||this.errors,c=b.length,d="";0!==c&&(this.form.find(".charitable-form-errors").length&&this.form.find(".charitable-form-errors").remove(),d+='<div class="charitable-form-errors charitable-notice"><ul class="errors"><li>',d+=b.join("</li><li>"),d+="</li></ul></div>",this.form.prepend(d))},c.prototype.clear_errors=function(){this.errors=[],this.form.find(".charitable-form-errors").length&&this.form.find(".charitable-form-errors").remove()},c.prototype.show_processing=function(){this.form.find(".charitable-form-processing").show(),this.form.find('button[name="donate"]').hide()},c.prototype.hide_processing=function(){this.form.find(".charitable-form-processing").hide(),this.form.find('button[name="donate"]').show()},c.prototype.scroll_to_top=function(){var a=this.form.parents(".charitable-modal");a.length?a.scrollTop(0):window.scrollTo(this.form.position().left,this.form.position().top)},c.prototype.get_data=function(){return this.form.serializeArray().reduce(function(a,b){return a[b.name]=b.value,a},{})},c.prototype.get_required_fields=function(){var a=this.form.find(".charitable-fieldset .required-field").not("#charitable-gateway-fields .required-field"),c=this.get_payment_method();if(""!==c){var d=this.form.find("[data-gateway="+c+"] .required-field");d.length&&(a=b.merge(a,d))}return a},c.prototype.is_valid_amount=function(){return this.get_amount()>0},c.prototype.validate_amount=function(){return!1===this.is_valid_amount()?(this.add_error(CHARITABLE_VARS.error_invalid_amount),!1):!0},c.prototype.validate_required_fields=function(){var a=!1;return this.get_required_fields().each(function(){""===b(this).find("input, select, textarea").val()&&(a=!0)}),a&&this.add_error(CHARITABLE_VARS.error_required_fields),a},c.prototype.validate=function(){return this.clear_errors(),this.validate_amount(),this.validate_required_fields(),this.form.trigger("charitable:form:validate",this),0===this.errors.length},a.Donation_Form=c}(CHARITABLE,jQuery),function(a,b){var c=function(){var a=function(){b("#"+b(this).data("charitable-toggle")).addClass("charitable-hidden")},c=function(){var a=b(this),c=a.data("charitable-toggle");return b("#"+c).toggleClass("charitable-hidden",a.is(":checked")),!1};return b("body").on("click","[data-charitable-toggle]",c),function(){b("[data-charitable-toggle]").each(a)}};a.Toggle=c()}(CHARITABLE,jQuery),function(a,b){}(CHARITABLE,jQuery),CHARITABLE.SanitizeURL=function(a){CHARITABLE.Helpers.sanitize_url(a)},function(a){CHARITABLE.forms_initialized=!1,a(document).ready(function(){var b=a(".charitable-donation-form");b.length&&new CHARITABLE.Donation_Form(b),CHARITABLE.Toggle()})}(jQuery);